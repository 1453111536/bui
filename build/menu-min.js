/**
 * @fileOverview \u83dc\u5355\u547d\u540d\u7a7a\u95f4\u5165\u53e3\u6587\u4ef6
 * @ignore
 */define("bui/menu",function(require){var e=require("bui/common"),t=e.namespace("Menu");return e.mix(t,{Menu:require("bui/menu/menu"),MenuItem:require("bui/menu/menuitem"),ContextMenu:require("bui/memu/contextmenu"),PopMenu:require("bui/menu/popmenu"),SideMenu:require("bui/menu/sidemenu")}),t.ContextMenuItem=t.ContextMenu.Item,t}),define("bui/menu/menuitem",function(require){var e=require("bui/common"),t=e.Component,n=t.UIBase,r=e.prefix,i=r+"menu-item-open",s="x-caret",o=r+"menu-item-collapsed",u="data-id",a=t.View.extend([n.ListItemView,n.CollapseableView],{_uiSetOpen:function(e){var t=this,n=t.getStatusCls("open");e?t.get("el").addClass(n):t.get("el").removeClass(n)}},{ATTRS:{}},{xclass:"menu-item-view"}),f=t.Controller.extend([n.ListItem,n.Collapseable],{renderUI:function(){var t=this,n=t.get("el"),r=t.get("id"),i=null;r||(r=e.guid("menu-item"),t.set("id",r)),n.attr(u,r)},handleMouseEnter:function(e){var t=this;this.get("subMenu")&&this.set("open",!0),f.superclass.handleMouseEnter.call(this,e)},handleMouseLeave:function(e){var t=this,n=t.get("subMenu"),r=e.toElement;r&&n&&n.containsElement(r)?t.set("open",!0):t.set("open",!1),f.superclass.handleMouseLeave.call(this,e)},containsElement:function(e){var t=this,n,r=f.superclass.containsElement.call(t,e);return r||(n=t.get("subMenu"),r=n&&n.containsElement(e)),r},_uiSetOpen:function(e){var t=this,n=t.get("subMenu"),r=t.get("subMenuAlign");if(n)if(e)r.node=t.get("el"),n.set("align",r),n.show();else{var i=n.get("align");(!i||i.node==t.get("el"))&&n.hide()}},_uiSetSubMenu:function(e){if(e){var t=this,n=t.get("el"),r=t.get("parent");e.get("parentMenu")||(e.set("parentMenu",r),r.get("autoHide")&&e.set("autoHide",!1)),$(t.get("arrowTpl")).appendTo(n)}},destructor:function(){var e=this,t=e.get("subMenu");t&&t.destroy()}},{ATTRS:{elTagName:{value:"li"},xview:{value:a},open:{view:!0,value:!1},subMenu:{view:!0},subMenuAlign:{valueFn:function(e){return{points:["tr","tl"],offset:[-5,0]}}},arrowTpl:{value:'<span class="'+s+" "+s+'-left"></span>'},events:{value:{afterOpenChange:!0}}}},{xclass:"menu-item",priority:0}),l=f.extend({},{ATTRS:{focusable:{value:!1},selectable:{value:!1},handleMouseEvents:{value:!1}}},{xclass:"menu-item-sparator"});return f.View=a,f.Separator=l,f}),define("bui/menu/menu",function(require){var e=require("bui/common"),t=e.Component,n=t.UIBase,r=t.View.extend([n.PositionView],{}),i=t.Controller.extend([n.Position,n.Align,n.ChildList,n.AutoHide],{bindUI:function(){var t=this;t.on("click",function(e){var n=e.target,r=t.get("multipleSelect");t!=n&&!r&&t.get("clickHide")&&!n.get("subMenu")&&t.getTopAutoHideMenu().hide()}),t.on("afterOpenChange",function(n){var r=n.target,i=n.newVal,s=t.get("children");i&&e.each(s,function(e){e!==r&&e.get("open")&&e.set("open",!1)})}),t.on("afterVisibleChange",function(e){var n=e.newVal,r=t.get("parentMenu");t._clearOpen()})},getTopAutoHideMenu:function(){var e=this,t=e.get("parentMenu"),n;return t&&t.get("autoHide")?t.getTopAutoHideMenu():e.get("autoHide")?e:null},_clearOpen:function(){var t=this,n=t.get("children");e.each(n,function(e){e.set&&e.set("open",!1)})},findItemById:function(e){return this.findItemByField("id",e)},_uiSetSelectedItem:function(e){e&&_self.setSelected(e)}},{ATTRS:{elTagName:{view:!0,value:"ul"},idField:{value:"id"},defaultChildClass:{value:"menu-item"},selectedItem:{},autoHide:{value:!1},clickHide:{value:!1},parentMenu:{},xview:{value:r}}},{xclass:"menu",priority:0});return i.View=r,i}),define("bui/menu/popmenu",function(require){var e=require("bui/common"),t=e.Component.UIBase,n=require("bui/menu/menu"),r=n.extend([t.AutoShow],{},{ATTRS:{clickHide:{value:!0},align:{value:{points:["bl","tl"],offset:[0,0]}},autoHide:{value:!0},visible:{value:!1}}},{xclass:"pop-menu"});return r}),define("bui/memu/contextmenu",function(require){var e=require("bui/common"),t=require("bui/menu/menuitem"),n=require("bui/menu/popmenu"),r=e.prefix,i=r+"menu-item-link",s=r+"menu-item-icon",o=e.Component,u=o.UIBase,a=t.extend({bindUI:function(){var e=this;e.get("el").delegate("."+i,"click",function(e){e.preventDefault()})},_uiSetIconCls:function(e,t){var n=this,r=t.prevVal,i=n.get("el").find("."+s);i.removeClass(r),i.addClass(e)}},{ATTRS:{text:{veiw:!0,value:""},iconCls:{sync:!1,value:""},tpl:{value:'<a class="'+i+'" href="#">        <span class="'+s+' {iconCls}"></span><span class="'+r+'menu-item-text">{text}</span></a>'}}},{xclass:"context-menu-item"}),f=n.extend({},{ATTRS:{defaultChildClass:{value:"context-menu-item"},align:{value:null}}},{xclass:"context-menu"});return f.Item=a,f}),define("bui/menu/sidemenu",function(require){var e=require("bui/common"),t=require("bui/menu/menu"),n=e.Component,r=e.prefix+"menu-title",i="menu-leaf",s=t.extend({initializer:function(){var t=this,n=t.get("items"),r=t.get("children");e.each(n,function(e){var n=t._initMenuCfg(e);r.push(n)})},bindUI:function(){var t=this,n=t.get("children");e.each(n,function(e){var t=e.get("children")[0];t&&t.publish("click",{bubbles:1})}),t.get("el").delegate("a","click",function(e){e.preventDefault()}),t.on("itemclick",function(e){var n=e.item,s=$(e.domTarget).closest("."+r);if(s.length){var o=n.get("collapsed");n.set("collapsed",!o)}else n.get("el").hasClass(i)&&(t.fire("menuclick",{item:n}),t.clearSelection(),t.setSelected(n))})},getItems:function(){var t=this,n=[],r=t.get("children");return e.each(r,function(e){var t=e.get("children")[0];n=n.concat(t.get("children"))}),n},_initMenuCfg:function(t){var n=this,i=t.items,s=[],o={xclass:"menu-item",elCls:"menu-second",collapsed:t.collapsed,selectable:!1,children:[{xclass:"menu",children:s}],content:'<div class="'+r+'"><s></s><span class="'+r+'-text">'+t.text+"</span></div>"};return e.each(i,function(e){var t=n._initSubMenuCfg(e);s.push(t)}),o},_initSubMenuCfg:function(e){var t=this,n={id:e.id,xclass:"menu-item",elCls:"menu-leaf",tpl:'<a href="{href}"><em>{text}</em></a>',href:e.href,text:e.text};return n}},{ATTRS:{autoInitItems:{value:!1},events:{value:{menuclick:!1}}}},{xclass:"side-menu"});return s});
